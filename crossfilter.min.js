(function(){function e(){function e(e){return e}function t(e,t){for(var n=0,r=t.length,i=new Array(r);n<r;++n){i[n]=e[t[n]]}return i}function r(e){function t(t,n,r,i){while(r<i){var s=r+i>>>1;if(e(t[s])<n)r=s+1;else i=s}return r}function n(t,n,r,i){while(r<i){var s=r+i>>>1;if(n<e(t[s]))i=s;else r=s+1}return r}n.right=n;n.left=t;return n}function s(e){function t(e,t,n){var i=n-t,s=(i>>>1)+1;while(--s>0)r(e,s,i,t);return e}function n(e,t,n){var i=n-t,s;while(--i>0)s=e[t],e[t]=e[t+i],e[t+i]=s,r(e,1,i,t);return e}function r(t,n,r,i){var s=t[--i+n],o=e(s),u;while((u=n<<1)<=r){if(u<r&&e(t[i+u])>e(t[i+u+1]))u++;if(o<=e(t[i+u]))break;t[i+n]=t[i+u];n=u}t[i+n]=s}t.sort=n;return t}function u(e){function n(n,r,i,s){var o=new Array(s=Math.min(i-r,s)),u,a,f,l;for(a=0;a<s;++a)o[a]=n[r++];t(o,0,s);if(r<i){u=e(o[0]);do{if(f=e(l=n[r])>u){o[0]=l;u=e(t(o,0,s)[0])}}while(++r<i)}return o}var t=s(e);return n}function f(e){function t(t,n,r){for(var i=n+1;i<r;++i){for(var s=i,o=t[i],u=e(o);s>n&&e(t[s-1])>u;--s){t[s]=t[s-1]}t[s]=o}return t}return t}function c(e){function n(e,n,i){return(i-n<h?t:r)(e,n,i)}function r(t,r,i){var s=(i-r)/6|0,o=r+s,u=i-1-s,a=r+i-1>>1,f=a-s,l=a+s;var c=t[o],h=e(c),p=t[f],d=e(p),v=t[a],m=e(v),g=t[l],y=e(g),b=t[u],w=e(b);var E;if(h>d)E=c,c=p,p=E,E=h,h=d,d=E;if(y>w)E=g,g=b,b=E,E=y,y=w,w=E;if(h>m)E=c,c=v,v=E,E=h,h=m,m=E;if(d>m)E=p,p=v,v=E,E=d,d=m,m=E;if(h>y)E=c,c=g,g=E,E=h,h=y,y=E;if(m>y)E=v,v=g,g=E,E=m,m=y,y=E;if(d>w)E=p,p=b,b=E,E=d,d=w,w=E;if(d>m)E=p,p=v,v=E,E=d,d=m,m=E;if(y>w)E=g,g=b,b=E,E=y,y=w,w=E;var S=p,x=d,T=g,N=y;t[o]=c;t[f]=t[r];t[a]=v;t[l]=t[i-1];t[u]=b;var C=r+1,k=i-2;var L=x<=N&&x>=N;if(L){for(var A=C;A<=k;++A){var O=t[A],M=e(O);if(M<x){if(A!==C){t[A]=t[C];t[C]=O}++C}else if(M>x){while(true){var _=e(t[k]);if(_>x){k--;continue}else if(_<x){t[A]=t[C];t[C++]=t[k];t[k--]=O;break}else{t[A]=t[k];t[k--]=O;break}}}}}else{for(var A=C;A<=k;A++){var O=t[A],M=e(O);if(M<x){if(A!==C){t[A]=t[C];t[C]=O}++C}else{if(M>N){while(true){var _=e(t[k]);if(_>N){k--;if(k<A)break;continue}else{if(_<x){t[A]=t[C];t[C++]=t[k];t[k--]=O}else{t[A]=t[k];t[k--]=O}break}}}}}}t[r]=t[C-1];t[C-1]=S;t[i-1]=t[k+1];t[k+1]=T;n(t,r,C-1);n(t,k+2,i);if(L){return t}if(C<o&&k>u){var D,_;while((D=e(t[C]))<=x&&D>=x)++C;while((_=e(t[k]))<=N&&_>=N)--k;for(var A=C;A<=k;A++){var O=t[A],M=e(O);if(M<=x&&M>=x){if(A!==C){t[A]=t[C];t[C]=O}C++}else{if(M<=N&&M>=N){while(true){var _=e(t[k]);if(_<=N&&_>=N){k--;if(k<A)break;continue}else{if(_<x){t[A]=t[C];t[C++]=t[k];t[k--]=O}else{t[A]=t[k];t[k--]=O}break}}}}}}return n(t,C,k+1)}var t=f(e);return n}function y(e){var t=new Array(e),n=-1;while(++n<e)t[n]=0;return t}function b(e,t){var n=e.length;while(n<t)e[n++]=0;return e}function w(e,t){if(t>32)throw new Error("invalid array width!");return e}function E(e,t){return function(n){var r=n.length;return[e.left(n,t,0,r),e.right(n,t,0,r)]}}function S(e,t){var n=t[0],r=t[1];return function(t){var i=t.length;return[e.left(t,n,0,i),e.left(t,r,0,i)]}}function x(e){return[0,e.length]}function T(){return null}function N(){return 0}function C(e){return e+1}function k(e){return e-1}function L(e){return function(t,n){return t+ +e(n)}}function A(e){return function(t,n){return t-e(n)}}function O(){function y(e){var t=o,n=e.length;if(n){i=i.concat(e);l=m(l,o+=n);d.forEach(function(r){r(e,t,n)})}return r}function b(){var e=M(o,o),t=[];for(var n=0,r=0;n<o;++n){if(l[n])e[n]=r++;else t.push(n)}h.forEach(function(e){e(0,[],t)});v.forEach(function(t){t(e)});for(var n=0,r=0,s;n<o;++n){if(s=l[n]){if(n!==r)l[r]=s,i[r]=i[n];++r}}i.length=r;while(o>r)l[--o]=0}function w(r){function z(e,n,i){P=e.map(r);H=B(_(i),0,i);P=t(P,H);var s=j(P),u=s[0],a=s[1],f;if(F){for(f=0;f<i;++f){if(!F(P[f],f))l[H[f]+n]|=y}}else{for(f=0;f<u;++f)l[H[f]+n]|=y;for(f=a;f<i;++f)l[H[f]+n]|=y}if(!n){w=P;O=H;R=u;U=a;return}var c=w,h=O,p=0,d=0;w=new Array(o);O=M(o,o);for(f=0;p<n&&d<i;++f){if(c[p]<P[d]){w[f]=c[p];O[f]=h[p++]}else{w[f]=P[d];O[f]=H[d++]+n}}for(;p<n;++p,++f){w[f]=c[p];O[f]=h[p]}for(;d<i;++d,++f){w[f]=P[d];O[f]=H[d]+n}s=j(w),R=s[0],U=s[1]}function W(e,t,n){I.forEach(function(e){e(P,H,t,n)});P=H=null}function X(e){for(var t=0,n=0,r;t<o;++t){if(l[r=O[t]]){if(t!==n)w[n]=w[t];O[n]=e[r];++n}}w.length=n;while(n<o)O[n++]=0;var i=j(w);R=i[0],U=i[1]}function V(e){var t=e[0],n=e[1];if(F){F=null;Y(function(e,r){return t<=r&&r<n});R=t;U=n;return p}var r,i,s,o=[],u=[];if(t<R){for(r=t,i=Math.min(R,n);r<i;++r){l[s=O[r]]^=y;o.push(s)}}else if(t>R){for(r=R,i=Math.min(t,U);r<i;++r){l[s=O[r]]^=y;u.push(s)}}if(n>U){for(r=Math.max(t,U),i=n;r<i;++r){l[s=O[r]]^=y;o.push(s)}}else if(n<U){for(r=Math.max(R,n),i=U;r<i;++r){l[s=O[r]]^=y;u.push(s)}}R=t;U=n;h.forEach(function(e){e(y,o,u)});return p}function $(e){return e==null?Q():Array.isArray(e)?K(e):typeof e==="function"?G(e):J(e)}function J(e){return V((j=E(n,e))(w))}function K(e){return V((j=S(n,e))(w))}function Q(){return V((j=x)(w))}function G(e){j=x;Y(F=e);R=0;U=o;return p}function Y(e){var t,n,r,i=[],s=[];for(t=0;t<o;++t){if(!(l[n=O[t]]&y)^!!(r=e(w[t],t))){if(r)l[n]&=b,i.push(n);else l[n]|=y,s.push(n)}}h.forEach(function(e){e(y,i,s)})}function Z(e){var t=[],n=U,r;while(--n>=R&&e>0){if(!l[r=O[n]]){t.push(i[r]);--e}}return t}function et(e){var t=[],n=R,r;while(n<U&&e>0){if(!l[r=O[n]]){t.push(i[r]);--e}n++}return t}function tt(t){function F(e,n,s,u){function I(){if(++p===c){v=g(v,f<<=1);a=g(a,f);c=D(f)}}var d=r,v=M(p,c),y=S,w=_,E=p,x=0,N=0,C,k,L,A,O,F;if(B)y=w=T;r=new Array(p),p=0;a=E>1?m(a,o):M(o,c);if(E)L=(k=d[0]).key;while(N<u&&!((A=t(e[N]))>=A))++N;while(N<u){if(k&&L<=A){O=k,F=L;v[x]=p;if(k=d[++x])L=k.key}else{O={key:A,value:w()},F=A}r[p]=O;while(!(A>F)){a[C=n[N]+s]=p;if(!(l[C]&b))O.value=y(O.value,i[C]);if(++N>=u)break;A=t(e[N])}I()}while(x<E){r[v[x]=p]=d[x++];I()}if(p>x)for(x=0;x<s;++x){a[x]=v[a[x]]}C=h.indexOf(P);if(p>1){P=U;H=W}else{if(!p&&j){p=1;r=[{key:null,value:w()}]}if(p===1){P=z;H=X}else{P=T;H=T}a=null}h[C]=P}function R(){if(p>1){var e=p,t=r,n=M(e,e);for(var i=0,s=0;i<o;++i){if(l[i]){n[a[s]=a[i]]=1;++s}}r=[],p=0;for(i=0;i<e;++i){if(n[i]){n[i]=p++;r.push(t[i])}}if(p>1){for(var i=0;i<s;++i)a[i]=n[a[i]]}else{a=null}h[h.indexOf(P)]=p>1?(H=W,P=U):p===1?(H=X,P=z):H=P=T}else if(p===1){if(j)return;for(var i=0;i<o;++i)if(l[i])return;r=[],p=0;h[h.indexOf(P)]=P=H=T}}function U(e,t,n){if(e===y||B)return;var s,o,u,f;for(s=0,u=t.length;s<u;++s){if(!(l[o=t[s]]&b)){f=r[a[o]];f.value=S(f.value,i[o])}}for(s=0,u=n.length;s<u;++s){if((l[o=n[s]]&b)===e){f=r[a[o]];f.value=x(f.value,i[o])}}}function z(e,t,n){if(e===y||B)return;var s,o,u,a=r[0];for(s=0,u=t.length;s<u;++s){if(!(l[o=t[s]]&b)){a.value=S(a.value,i[o])}}for(s=0,u=n.length;s<u;++s){if((l[o=n[s]]&b)===e){a.value=x(a.value,i[o])}}}function W(){var e,t;for(e=0;e<p;++e){r[e].value=_()}for(e=0;e<o;++e){if(!(l[e]&b)){t=r[a[e]];t.value=S(t.value,i[e])}}}function X(){var e,t=r[0];t.value=_();for(e=0;e<o;++e){if(!(l[e]&b)){t.value=S(t.value,i[e])}}}function V(){if(B)H(),B=false;return r}function $(e){var t=d(V(),0,r.length,e);return E.sort(t,0,t.length)}function J(e,t,r){S=e;x=t;_=r;B=true;return n}function K(){return J(C,k,N)}function Q(e){return J(L(e),A(e),N)}function G(e){function t(t){return e(t.value)}d=u(t);E=s(t);return n}function Y(){return G(e)}function Z(){return p}function et(){var e=h.indexOf(P);if(e>=0)h.splice(e,1);e=I.indexOf(F);if(e>=0)I.splice(e,1);e=v.indexOf(R);if(e>=0)v.splice(e,1);return n}var n={top:$,all:V,reduce:J,reduceCount:K,reduceSum:Q,order:G,orderNatural:Y,size:Z,dispose:et,remove:et};q.push(n);var r,a,f=8,c=D(f),p=0,d,E,S,x,_,P=T,H=T,B=true,j=t===T;if(arguments.length<1)t=e;h.push(P);I.push(F);v.push(R);F(w,O,0,o);return K().orderNatural()}function nt(){var e=tt(T),t=e.all;delete e.all;delete e.top;delete e.order;delete e.orderNatural;delete e.size;e.value=function(){return t()[0].value};return e}function rt(){q.forEach(function(e){e.dispose()});var e=d.indexOf(z);if(e>=0)d.splice(e,1);e=d.indexOf(W);if(e>=0)d.splice(e,1);e=v.indexOf(X);if(e>=0)v.splice(e,1);a&=b;return Q()}var p={filter:$,filterExact:J,filterRange:K,filterFunction:G,filterAll:Q,top:Z,bottom:et,group:tt,groupAll:nt,dispose:rt,remove:rt};var y=~a&-~a,b=~y,w,O,P,H,B=c(function(e){return P[e]}),j=x,F,I=[],q=[],R=0,U=0;d.unshift(z);d.push(W);v.push(X);a|=y;if(f>=32?!y:a&(1<<f)-1){l=g(l,f<<=1)}z(i,0,o);W(i,0,o);return p}function O(){function a(e,r){var s;if(u)return;for(s=r;s<o;++s){if(!l[s]){t=n(t,i[s])}}}function f(e,s,o){var a,f,c;if(u)return;for(a=0,c=s.length;a<c;++a){if(!l[f=s[a]]){t=n(t,i[f])}}for(a=0,c=o.length;a<c;++a){if(l[f=o[a]]===e){t=r(t,i[f])}}}function c(){var e;t=s();for(e=0;e<o;++e){if(!l[e]){t=n(t,i[e])}}}function p(t,i,o){n=t;r=i;s=o;u=true;return e}function v(){return p(C,k,N)}function m(e){return p(L(e),A(e),N)}function g(){if(u)c(),u=false;return t}function y(){var t=h.indexOf(f);if(t>=0)h.splice(t);t=d.indexOf(a);if(t>=0)d.splice(t);return e}var e={reduce:p,reduceCount:v,reduceSum:m,value:g,dispose:y,remove:y};var t,n,r,s,u=true;h.push(f);d.push(a);a(i,0,o);return v()}function P(){return o}var r={add:y,remove:b,dimension:w,groupAll:O,size:P};var i=[],o=0,a=0,f=8,l=p(0),h=[],d=[],v=[];return arguments.length?y(arguments[0]):r}function M(e,t){return(t<257?p:t<65537?d:v)(e)}function _(e){var t=M(e,e);for(var n=-1;++n<e;)t[n]=n;return t}function D(e){return e===8?256:e===16?65536:4294967296}O.version="1.3.11";O.permute=t;var n=O.bisect=r(e);n.by=r;var i=O.heap=s(e);i.by=s;var o=O.heapselect=u(e);o.by=u;var a=O.insertionsort=f(e);a.by=f;var l=O.quicksort=c(e);l.by=c;var h=32;var p=y,d=y,v=y,m=b,g=w;if(typeof Uint8Array!=="undefined"){p=function(e){return new Uint8Array(e)};d=function(e){return new Uint16Array(e)};v=function(e){return new Uint32Array(e)};m=function(e,t){if(e.length>=t)return e;var n=new e.constructor(t);n.set(e);return n};g=function(e,t){var n;switch(t){case 16:n=d(e.length);break;case 32:n=v(e.length);break;default:throw new Error("invalid array width!")}n.set(e);return n}}return O}if(typeof define==="function"&&define.amd){define(e)}else{window.crossfilter=e}})()